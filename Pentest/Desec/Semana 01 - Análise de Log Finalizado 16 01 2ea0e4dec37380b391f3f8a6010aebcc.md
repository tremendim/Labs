# Semana 01 - Análise de Log *Finalizado 16/01

## Análise de Logs I

## Análise de Logs II

## Qual o endereço IP do Atacante?

Para chegar no resultado tenho que filtrar por qual IP tem mais ativações

```bash
cat access.log | cut -d " " -f 1 | sort | uniq -c | sort -un
```

Cut para separar os dados pelo espaço pegando a primeira parte| sort nao sei | uniq -c para contar os valores repetidos| sort -un para colocar em ordem crescente

Dessa forma chegamos no resultado

```bash
┌──(kali㉿kali)-[~/Documents/Desec/Semana01]
└─$ cat access.log | cut -d " " -f 1 | sort | uniq -c | sort -un
      1 109.122.33.112
      2 128.61.240.66
      5 62.210.74.47
      6 199.180.112.34
     13 119.37.196.120
     24 187.75.38.126
     25 177.94.112.125
     26 201.46.150.143
     29 187.38.19.108
     31 85.236.52.212
     32 199.193.251.194
     45 191.181.5.157
     49 187.101.118.104
    161 189.36.234.53
  37038 177.138.28.7

```

## Análise de Logs III

## Quando o ataque começou e quando terminou?

Para chegar no resultado posso filtrar os logs pelo IP utilizando grep

```bash
cat access.log  | grep 177.138.28.7 | head -1
177.138.28.7 - - [13/Feb/2015:00:21:12 -0200] "GET / HTTP/1.1" 200 2533 "https://www.facebook.com/" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36"

```

head -1 para pegar a primeira linha

```bash
cat access.log  | grep 177.138.28.7 | tail -1
177.138.28.7 - - [13/Feb/2015:08:58:35 -0200] "GET /cgi-bin/mchat.cgi HTTP/1.1" 404 540 "-" "Mozilla/5.00 (Nikto/2.1.6) (Evasions:None) (Test:001526)"

```

tail -1 para pegar a ultima linha

## Investigando o ataque LAB 01

## Examine o arquivo de log e identifique o endereço IP do atacante.

Cheguei ao resultado utilizando o mesmo comando do analise de logs ii

```bash
cat lab.log | cut -d " " -f 1 |sort| uniq -c
     52 ::1
      1 104.211.216.163
     71 138.204.84.95
      1 158.140.180.170
      3 177.154.139.197
     51 177.154.145.99
      3 185.6.9.205
      1 186.202.173.147
      9 189.102.100.189
     26 189.29.147.17
     24 189.4.82.26
      1 191.255.183.136
      1 196.52.2.31
     26 201.78.230.51
   1896 205.251.150.186
      1 45.231.194.246
      1 47.89.192.12
      2 66.102.6.117
      1 94.183.117.16

```

## Investigando o ataque LAB 02

## Examine o arquivo de log e responda em qual diretório o atacante encontrou a informação sensível?

Comecei filtrando o log pelo IP do atacante

```bash
cat lab.log | grep 205.251.150.186

```

Cheguei no resultado filtrando por Linux,  a logica foi que ele conseguiu acessar as informações utilizando alguma maquina então filtrei por Linux para fugir dos Scripts

```bash
cat lab.log | grep 205.251.150.186 | cut -d "]" -f 2 | grep Linux
 "GET /config HTTP/1.1" 404 503 "-" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /configuracao HTTP/1.1" 404 506 "-" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /configuracao/ HTTP/1.1" 404 507 "-" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /configuracoes/ HTTP/1.1" 200 706 "-" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /icons/blank.gif HTTP/1.1" 200 438 "http://businesscorp.com.br/configuracoes/" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /icons/back.gif HTTP/1.1" 200 505 "http://businesscorp.com.br/configuracoes/" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /icons/unknown.gif HTTP/1.1" 200 534 "http://businesscorp.com.br/configuracoes/" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /intranet/ HTTP/1.1" 200 406 "-" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "POST /intranet/ HTTP/1.1" 200 406 "http://businesscorp.com.br/intranet/" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "POST /intranet/ HTTP/1.1" 200 406 "http://businesscorp.com.br/intranet/" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "POST /intranet/ HTTP/1.1" 200 333 "http://businesscorp.com.br/intranet/" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /intranet/ HTTP/1.1" 200 406 "-" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
```

## Investigando o ataque LAB 03

## Examine o arquivo de log e responda qual o nome do arquivo sensivel que o atacante baixou

Cheguei ao resultado (db.sql) filtrando os logs por configuracoes que é a pagina sensivel

```bash
 cat lab.log | grep 205.251.150.186 | cut -d "]" -f 2 | grep configuracoes
 "GET /configuracoes/ HTTP/1.1" 200 706 "-" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /icons/blank.gif HTTP/1.1" 200 438 "http://businesscorp.com.br/configuracoes/" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /icons/back.gif HTTP/1.1" 200 505 "http://businesscorp.com.br/configuracoes/" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /icons/unknown.gif HTTP/1.1" 200 534 "http://businesscorp.com.br/configuracoes/" "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0"
 "GET /configuracoes/db.sql HTTP/1.1" 200 573 "-" "Wget/1.20.3 (linux-g
```

## LAB 04

## Examine o arquivo de log e responda qual o nome e versão da ferramenta utilizada para baixar o arquivo sensível?

Resposta ja estava no proprio log anterior