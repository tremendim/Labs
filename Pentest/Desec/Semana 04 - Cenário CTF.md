# Semana 04 - Cenário: CTF

# Cenário: Capture the Flag

A equipe de segurança ofensiva criou um CTF (capture the flag) para testar as habilidades
técnicas dos participantes e identificar novos talentos.
Até o momento você era um analista de segurança mas essa pode ser a sua oportunidade para
fazer parte do time de segurança ofensiva e entrar mais fundo no mundo do Pentest. (Etapa:
Penetration Testing

---

## CTF - Offsec Team

Lab ID: beee791354a71ca0daad919ba87993d7a44f160b

**Enunciado do Lab**

O time de offsec conseguiu o seguinte monitoramento.

Analise o arquivo e responda quais portas estavam abertas durante o monitoramento.

Insira as portas em ordem crescente e separadas por vírgula

**R- 33024,33054,43001,44289,49222**

### Solução

Foi utilizado o comando  `tcpdump -r monitoramento.pcapng 'tcp[tcpflags] == (tcp-syn|tcp-ack)'`  onde estamos realizando um filtro que diz ‘mostre apenas pacotes TCP que tenham simultaneamente as flags Syn e Ack que correspondem a uma resposta do servidor dizendo que a porta está aberta

---

## **CTF - Offsec Team II**

Lab ID:

**Enunciado do Lab**

Analisando as portas encontradas anteriormente foi possível obter alguma key?

**R- = b4nn3rgr4bbing122938842**

172.16.1.55 PORT 44905 b4nn3rgr4bbing122938842

### Solução

Foi utilizado do Script a baixo para pegar o banner do Ip 172.16.1.3 e as portas do resultado anterior. A porta 49222 retornou a flag

![image.png](Assets/image%206.png)

---

## **CTF - Offsec Team III**

Lab ID:

**Enunciado do Lab**

Qual o socket encontrado?

**R- = 172.16.1.55:44905**

### Solução

Todas outras portas continham uma parte do resultado

![image.png](Assets/image%207.png)

---

## **CTF - Offsec Team IV**

Lab ID:cd15eea6c2342839a83f4f08351e864fd8932f3f

**Enunciado do Lab**

Após decodificar a resposta do serviço responda:

Qual o protocolo foi utilizado?

**R- = ICMP**

### Solução

Após utilizar o Script no Socket do ultimo resultado tive o seguinte retorno

45 00 00 4c d1 b4 00 00 40 01 4e a3 ac 10 01 37 - ac 10 01 02 08 00 dc 3a 83 08 00 00 64 73 74 20 - 68 74 74 70 20 70 6f 72 74 20 38 30 20 2f 6d 61 - 6c 77 61 72 65 2e 74 78 74 20 2d 20 4b 45 59 3a - 20 30 30 32 39 38 34 31 37 31 37 32

Fazendo uma analise dos Bytes chegamos ao resultado, seguindo byte por byte como referencia a legenda de cores a baixo

Cabeçalho IPV4

Versão e tamanho do cabeçalho

Tamanho total do pacote

Identificação do pacote

Flags de Fragmentos

TTL

Protocolo = ICMP

Checksum

Endereço de Origem e Dest

AC 10 01 37 - Origem

AC 10 01 02 - Destino

Cabeçalho ICMP

- 08 00: Tipo e Código
- DC 3A: Checksum dos dados ICMP
- 83 08 00 00: Identificador e Número de Sequência do ping.

Payload

64 73 74 20 - 68 74 74 70 20 70 6f 72 74 20 38 30 20 2f 6d 61 - 6c 77 61 72 65 2e 74 78 74 20 2d 20 4b 45 59 3a - 20 30 30 32 39 38 34 31 37 31 37 32

---

## **Offsec Team V**

Lab ID: 

**Enunciado do Lab**

Qual o endereço IP de destino?

**R- =** 172.16.1.2

### Solução

Convertendo AC 10 01 02 para decimal temos 172.16.1.2

---

## Offsec Team V

Lab ID:

**Enunciado do Lab**

Qual a key encontrada?

**R- =**00298417172

### Solução

Convertendo o Payload para decimal chegamos ao seguinte resultado: "dst http port 80 /malware.txt - KEY: 00298417172”

---

## Offsec Team VI

Lab ID:

**Enunciado do Lab**

Qual o nome do arquivo informado?

**R- = malware.txt**

### Solução

Resposta está no ultimo enunciado

---

## Offsec Team VII

Lab ID:

**Enunciado do Lab**

Indo mais além na pesquisa responda:

Qual a key final?

- *R- =9884277111882999a2

### Solução

Utilizando as respostas anteriores temos o IP Destino: 172.16.1.2 na porta 80 com a URL /malware.txt

Baixando esse arquivo chegamos no resultado

![image.png](Assets/image%208.png)

---