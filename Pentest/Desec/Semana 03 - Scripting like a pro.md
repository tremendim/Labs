# Semana 03 - Scripting like a pro

# Cenario: Malware na rede

Neste contexto você ainda não é um pentester mas já é um profissional com conhecimentos em
segurança da informação.
Devido aos últimos problemas que você solucionou, você ganhou um destaque maior na
empresa e hoje o chefe de segurança já vem direto a você quando um novo problema aparece
pois você sempre encontra uma forma de resolve-lo.
Hoje um dos maiores sites de notícias reportou um novo malware que tem assombrado o país,
o malware se aloja em servidores e é ativado pelo atacante via rede, quando ativo o malware
extrai informações do host infectado.
Segundo os especialistas o malware é ativado por envio de pacotes na rede, após o envio de
determinados pacotes em uma determinada sequência o malware habilita a porta de acesso. O
mesmo ocorre para desativar o malware.
O time de monitoramento reportou um comportamento anormal em um dos servidores da
Business Corp mas não tiveram sucesso em válidar se o servidor está infectado.
O chefe de segurança disse que sabe quem no time vai resolver e passou o desafio para você.
[https://academy.desecsecurity.com/down/malware.pcap](https://academy.desecsecurity.com/down/malware.pcap)
Analise o malware.pcap e resposta os VLABS.

## HTML Parsing

Lab ID:30bc7b9945096b22e4488915627700795ea8b4b0

**Enunciado do Lab**

Utilize o script que você construiu para fazer análise de html e identifique o subdomínio correto.

Ex: site.businesscorp.com.br

[http://www.businesscorp.com.br/](http://www.businesscorp.com.br/)

**R-** [parsingok.businesscorp.com.br](parsingok.businesscorp.com.br)

### Solução

Desenvolvi o seguinte script e executando ele no site proposto cheguei ao resultado

```bash
!/bin/bash
if [ $1 == ""]
then
        echo "#######################################"
        echo "|->           PARSING HTML          <-|"
        echo "|->        Desec Security - Luis    <-|"
        echo "|-> ./ScriptScan.sh www.alvo.com.br <-|"
        echo "#######################################"
else
wget $1 &> /dev/null
        echo "#########################################"
        echo "|->           Buscando Hosts          <-|"
        echo "#########################################"
grep href index.html | cut -d "/" -f 3 | grep "\." | cut -d '"' -f 1 | grep -v "<l" > lista
cat lista

rm index.html
 
        echo "#########################################"
        echo "|->           Resolvendo Hosts        <-|"
        echo "#########################################"

for url in $(cat lista);do host $url;done
fi

```

---

## HTML Parsing 2

Lab ID: f64bd75829448a184a892a5fdd3b2d9d55ccfaad

**Enunciado do Lab**

Utilize o script que você construiu para fazer análise de html e identifique o endereço IP do subdomínio encontrado.

**R- 37.59.174.225**

### Solução

Resultado encontrado com o Script a cima.

![image.png](Assets/image%205.png)

---

## **Título do Lab IIi**

Lab ID:

**Enunciado do Lab**

**R- Evidência usada como resposta**

### Solução

```bash
Descreva aqui a solução do laboratório, quais dificuldades teve e como consguiu chgar à solução, insira os códigos em blocos separados e as mudanças de exploits ou PoCs também.
```

---

## **Título do Lab II**

Lab ID:

**Enunciado do Lab**

**R- Evidência usada como resposta**

### Solução

```bash
Descreva aqui a solução do laboratório, quais dificuldades teve e como consguiu chgar à solução, insira os códigos em blocos separados e as mudanças de exploits ou PoCs também.
```

---

## **Título do Lab II**

Lab ID:

**Enunciado do Lab**

**R- Evidência usada como resposta**

### Solução

```bash
Descreva aqui a solução do laboratório, quais dificuldades teve e como consguiu chgar à solução, insira os códigos em blocos separados e as mudanças de exploits ou PoCs também.
```

---

## **Título do Lab II**

Lab ID:

**Enunciado do Lab**

**R- Evidência usada como resposta**

### Solução

```bash
Descreva aqui a solução do laboratório, quais dificuldades teve e como consguiu chgar à solução, insira os códigos em blocos separados e as mudanças de exploits ou PoCs também.
```

---

## **Título do Lab II**

Lab ID:

**Enunciado do Lab**

**R- Evidência usada como resposta**

### Solução

```bash
Descreva aqui a solução do laboratório, quais dificuldades teve e como consguiu chgar à solução, insira os códigos em blocos separados e as mudanças de exploits ou PoCs também.
```

---

## **Título do Lab II**

Lab ID:

**Enunciado do Lab**

**R- =**

### Solução

```bash

```

---